<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Ejercicio Clase No 1</title>
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"
    />
    <script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"></script>
    <style>
      #map {
        width: 100%;
        height: 600px;
      }
    </style>
    <script type="text/javascript" src="paises.js"></script>
    <script type="text/javascript" src="ciudades.js"></script>
    <script type="text/javascript" src="departamentos.js"></script>
    <script type="text/javascript" src="hidrografia.js"></script>
  </head>
  <body>
    <div id="map"></div>
    <script>
      // Inicializa el mapa y establece la vista al punto de latitud y longitud dados y el nivel de zoom
      var map = L.map("map", {
        center: [4.570868, -74.297333], // Coordenadas de Colombia
        zoom: 4,
        scrollWheelZoom: false,
      });

      // Capa base de OpenStreetMap
      var osmLayer = L.tileLayer(
        "https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",
        {
          maxZoom: 18,
          attribution:
            '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',
        }
      ).addTo(map);
      // Capa base Google Satellite
      var GoogleSatellite = L.tileLayer(
        "https://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}",
        {
          maxZoom: 20,
          subdomains: ["mt0", "mt1", "mt2", "mt3"],
          attribution:
            '&copy; <a href="https://www.google.com/maps">Google Maps</a>',
        }
      ).addTo(map);

      var paisesLayer = L.geoJson(paises, {
        style: function (feature) {
          return {
            fillColor: getContinentColor(feature.properties.continent),
            weight: 2,
            opacity: 1,
            color: "white",
            dashArray: "3",
            fillOpacity: 0.7,
          };
        },
      });

      var ciudadesLayer = L.geoJson(ciudades, {
        pointToLayer: function (feature, latlng) {
          var color = feature.properties.capital === "Yes" ? "yellow" : "green";
          var shape =
            feature.properties.capital === "Yes" ? "circle" : "square";
          if (shape === "circle") {
            return L.circleMarker(latlng, {
              radius: 6,
              fillColor: color,
              color: "#000",
              weight: 1,
              opacity: 1,
              fillOpacity: 0.8,
            });
          } else {
            return L.rectangle([latlng, latlng], {
              fillColor: color,
              color: "#000",
              weight: 1,
              opacity: 1,
              fillOpacity: 0.8,
            });
          }
        },
      });

      var departamentosLayer = L.geoJson(departamentos, {
        style: function (feature) {
          return {
            fillColor: "#FFEDA0",
            weight: 2,
            opacity: 1,
            color: "black",
            dashArray: "0",
            fillOpacity: 0.9,
          };
        },
      });

      var hidrografiaLayer = L.geoJson(hidrografia, {
        style: function () {
          return {
            color: "blue",
            weight: 1,
          };
        },
      });

      // Control de capas
      var baseMaps = {
        OpenStreetMap: osmLayer,

      };

      var overlayMaps = {
        Paises: paisesLayer,
        Departamentos: departamentosLayer,
        HidrografÃ­a: hidrografiaLayer,
        Ciudades: ciudadesLayer,
      };

      function getColor(d) {
        return d > 100000000
          ? "#800026"
          : d > 50000000
          ? "#BD0026"
          : d > 20000000
          ? "#E31A1C"
          : d > 10000000
          ? "#FC4E2A"
          : d > 5000000
          ? "#FD8D3C"
          : d > 2000000
          ? "#FEB24C"
          : d > 1000000
          ? "#FED976"
          : "#FFEDA0";
      }

      function getstyle(feature) {
        return {
          fillColor: getColor(feature.properties.pop_est),
          weight: 2,
          opacity: 1,
          color: "white",
          dashArray: "3",
          fillOpacity: 0.7,
        };
      }

      function popup(feature, layer) {
        if (feature.properties && feature.properties.name) {
          layer.bindPopup(feature.properties.name);
        }
      }

      L.control.layers(baseMaps, overlayMaps).addTo(map);
      L.control.scale().addTo(map);
      L.geoJson(datospaises, {
        style: getstyle,
        onEachFeature: popup,
      }).addTo(map);
    </script>
  </body>
</html>
